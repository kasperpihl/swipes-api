@import '~styles/_vars.scss/';
@import '~styles/_mixins.scss/';

// ======================================================
// Block
// ======================================================

.step-list {
  @include size(100%, auto);
}

.step-list-item {
  $b: &;
  $flexIgnoreList: '#{$b}__indicator', '#{$b}__assignees';

  @include size(100%, auto);
  @include flexContainer('row', left, stretch, $flexIgnoreList);
  @include heightSpecifications(66px, initial);
  background-color: $bg;
  border-top: 1px solid $deepBlue-5;
  transition: 0s;
}

.add-step {
  $b: &;
  $flexIgnoreList: '#{$b}__indicator';

  @include size(100%, 67px);
  @include flexContainer('row', left, center, $flexIgnoreList);
  border-top: 1px solid $deepBlue-5;
  //border-bottom: 1px solid $deepBlue-5;
  transition: .15s ease;
}

// ======================================================
// Elements
// ======================================================

.step-list {

  &__edit-button {
    @include font(12px, $deepBlue-40, 15px, 400);
    user-select: none;

    &:hover {
      @include font($c: $blue-100);
      text-decoration: underline;
    }

    &--done {
      @include font($c: $blue-100)
    }
  }
}

.step-list-item {
  $b: &;

  &__sortable {
    box-shadow: 0 1px 20px 3px rgba($blue-160, .1);
    padding: 0 15px;
    z-index: 99999999999;
  }

  &__indicator {
    @include size(49px, initial);
    @include flexContainer('row', left, center);
    transition: .15s ease;

    #{$b}--target {

      .indicator__number {
        transform: translateX(30px);
        transition: .3s ease;
      }
    }
  }

  &__title {
    @include size(100%, initial);
    @include font(15px, $deepBlue-80, 24px);
    @include flexContainer('row', left, center);
    padding: 18px 0;
    transition: .15s ease;
    cursor: text;
  }

  &__assignees {
    @include flexContainer('row', center, center);
    padding-left: 6px;
    transition: .15s ease;
  }
}

// step list number indicator

.step-list-item {

  .indicator {
    $b: &;
    @include size(30px);
    @include flexContainer('row', center, center);
    background-color: $green-color;
    border: 2px solid $green-color;
    border-radius: 50%;
    overflow: hidden;
    transition: .3s ease;

    &__number {
      @include font(13px, $bg, 16px, bold);
      transition: .3s ease;
    }

    &__icon {
      @include size(30px);
      @include flexContainer('row', center, center);
      position: absolute;
      left: 0; top: -2px;
      transform: translateX(-32px);
      transition: .3s ease;
    }

    &__svg {
      @include size(24px);
      @include svg-color($deepBlue-100);
    }
  }
}

// Tooltip

.step-list-item {

  &__tooltip {
    @include font(12px, $bg, 500);
    background-color: $deepBlue-100;
    padding: 10px 15px;
    pointer-events: none;
    white-space: nowrap;
    animation: fadeRight .3s ease forwards;
  }
}

.step-list {

  .add-step {
    $b: &;

    &__input {
      @include size(100%, auto);
      @include font(15px, $deepBlue-100, 24px);
      order: 2;

      &::-webkit-input-placeholder {
        @include font(15px, $deepBlue-30, 24px);
        font-style: italic;
      }

      &:not(:placeholder-shown) + .add-step__indicator {
        border: 2px solid $deepBlue-100;
        color: rgba($deepBlue-100, 1);
        transition: .3s ease;
      }
    }

    &__indicator {
      @include size(30px);
      @include flexContainer('row', center, center);
      border: 5px solid $deepBlue-20;
      border-radius: 50%;
      color: rgba($deepBlue-100, 0);
      transition: .3s ease;
      margin-right: 18px;
      transform: scale(.4);
      order: 1;
    }

    &--focused {
      .add-step__indicator {
        transform: scale(1.0);
        border: 2px solid $deepBlue-20;
      }
    }

    &__loader {
      @include size(24px);
      border-radius: 50%;

      &:before {
        @include size(24px);
        position: absolute;
        left: 0; top: 0;
        content: '';
        border-radius: 50%;
        background-color: $blue-100;
        -webkit-clip-path: polygon(100% 0, 100% 50%, 50% 50%, 50% 0);
        opacity: 0;
        transition: .2s ease;
      }

      &:after {
        @include size(18px);
        position: absolute;
        left: 3px; top: 3px;
        content: '';
        border-radius: 50%;
        background-color: $bg;
        opacity: 0;
        transition: .2s .2s ease;
      }
    }
  }
}

// ======================================================
// Modifiers
// ======================================================

.step-list-item {
  $b: &;

  &--current {

    .indicator {
      background-color: $bg;
      border: 2px solid $deepBlue-100;

      &__number {
        @include font($c: $deepBlue-100);
      }
    }
  }

  &--loading {
    opacity: 1;
  }
}

.add-step {
  $b: &;

  &--loading {

    #{$b}__indicator {
      border: 0px solid transparent !important;
      transition: .2s;
    }

    #{$b}__loader {
      animation: rotateAddLoader 1s .25s cubic-bezier(.56,.31,.52,.78) infinite;

      &:before {
        opacity: 1;
        transition: .2s .2s ease;
      }

      &:after {
        opacity: 1;
        transition: 0s .2s ease;
      }
    }
  }
}

// editing

.step-list-item {
  $b: &;

  &--editing {
    $flexIgnoreList: '#{$b}__remove', '#{$b}__assignees';

    @include flexContainer('row', left, center, $flexIgnoreList);
    padding: 12px 0;
    transition: 0s;

    #{$b}__remove {
      padding-right: 13px;
    }

    input#{$b}__input {
      @include size(100%, auto);
      @include font(15px, $blue-100, 24px);
      text-shadow: 0px 0px 0px $deepBlue-60;
      -webkit-text-fill-color: transparent;
      padding: 9px 0;
      padding-right: 9px;

      &:focus {
        text-shadow: 0px 0px 0px $deepBlue-100;
      }
    }
  }
}

// ======================================================
// Targeting
// ======================================================

.step-list-item {

  &:first-child {
    border-top: 0px solid red;
  }
}

// ======================================================
// Hover
// ======================================================

.step-list-item {
  $b: &;

  &:hover {
    opacity: 1;

    #{$b}__title, #{$b}__assignees {
      opacity: 1;
      transition: .15s ease;
    }
  }

  &__indicator:hover {
    .indicator__number {
      transform: translateX(30px);
      transition: .3s ease;
    }

    .indicator__icon {
      transform: translateX(-2px);
      transition: .3s ease;
    }
  }

  &--completed #{$b}__indicator:hover {

    .indicator {
      background-color: $bg;
      border: 2px solid $deepBlue-100;

      &__number {
        @include font($c: $deepBlue-100);
      }

      &__svg {
        @include svg-color($deepBlue-100);
      }
    }
  }

  &--current #{$b}__indicator:hover {

    .indicator {
      background-color: $green-color;
      border: 2px solid $green-color;

      &__number {
        @include font($c: $bg);
      }

      &__svg {
        @include svg-color($bg);
      }
    }
  }
}

@keyframes rotateAddLoader {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

@keyframes fadeRight {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }

  to {
    opacity: 1;
    transform: translateX(0px);
  }
}
