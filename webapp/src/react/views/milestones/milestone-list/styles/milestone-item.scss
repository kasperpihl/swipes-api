@import '~styles/_vars.scss';
@import '~styles/_mixins.scss';
@import '~styles/_functions.scss/';

// ======================================================
// Block
// ======================================================

.milestone {
  @include size(calc(33% - 15px), auto);
  @include widthSpecifications(300px, 50%);
  border-radius: 6px;
  flex-basis: 300px;
  flex-basis: 33%;
  flex-shrink: 0;
  flex-grow: 1;
  padding: 30px 15px;
  transition: .25s ease;

  .progress {
    @include size(54px);
    @include centerAbsolute();
    @include flexContainer('row', center, center);
    background-color: $bg;
    border-radius: 50%;
  }

  .progress-number {
    @include size(120px);
    @include centerAbsolute();
    @include flexContainer('row', center, center);
    background-color: $bg;
    border-radius: 50%;
    opacity: 0;
    transition: .2s ease;
  }

  .last-activity {
    $b: &;
    $flexIgnoreList: '#{$b}__left', '#{$b}__icon}';

    @include size(100%, auto);
    @include flexContainer('row', left, center, $selectorsToIgnoreFlex: $flexIgnoreList);
  }

  .header {
    $b: &;
    $flexIgnoreList: '#{$b}__icon}';

    @include size(100%, auto);
    @include flexContainer('row', left, center, $selectorsToIgnoreFlex: $flexIgnoreList);
  }
}

// ======================================================
// Elements
// ======================================================

.milestone {

  &__subtitle {
    @include size(100%, auto);
    @include font(12px, $deepBlue-50, 15px);
    margin-top: 6px;
  }

  &__progress {
    @include size(100%, 212px);
    border-top: 1px solid $deepBlue-5;
    border-bottom: 1px solid $deepBlue-5;
    margin-bottom: 12px;
    margin-top: 15px;
    transition: .25s ease;
  }

  &__svg {
    @include size(150px);
    @include centerAbsolute($addToTransform: rotateY(180deg));
    transition: .5s ease;

    path {
      stroke-miterlimit: 10;
      stroke-width: 48px;
      transition: stroke-width .4s ease, opacity .3s ease, fill .3s ease, stroke .3s ease;
    }

    &--bg {
      @include svg-color($deepBlue-5);
    }

    &--fg {
      @include svg-color($dark-green);
    }

    &--closed {
      @include svg-color($deepBlue-30);
    }
  }
}

.milestone .header {
  $b: getElementSelectorInBlock(#{&}, '.milestone');

  #{$b}__left {
    @include size(100%, auto);
    @include flexContainer('column', left, center);
  }

  #{$b}__title {
    @include size(100%, auto);
    @include font(21px, $deepBlue-100, 27px);
    @include truncateString();
    transition: .25s ease;
  }

  #{$b}__icon {
    @include size(24px);
  }

  #{$b}__svg {
    @include size(24px);
    @include svg-color($deepBlue-100);
    opacity: 0;
    transition: .3s ease;
    transform: translate3d(-15px, 0px, 0px);
  }
}

.milestone .last-activity {
  $b: getElementSelectorInBlock(#{&}, '.milestone');

  #{$b}__left {
    @include flexContainer('row', center, center);

    img {
      @include size(30px);
      border-radius: 50%;
    }
  }

  #{$b}__right {
    @include size(100%, auto);
    padding-left: 12px;
  }

  #{$b}__name {
    @include size(100%, auto);
    @include font(12px, $deepBlue-60, 15px, 500);
  }

  #{$b}__label {
    @include size(100%, auto);
    @include font(12px, $deepBlue-50, 15px);
  }
}

.milestone .progress {
  $b: getElementSelectorInBlock(#{&}, '.milestone');

  #{$b}__dot {
    @include size(6px);
    background-color: $deepBlue-100;
    border-radius: 50%;
  }

  #{$b}__number {
    @include flexContainer('row', center, center);
    @include size(54px);
    background-color: $bg;
    border-radius: 50%;
    left: calc(50% - (54px / 2)); top: calc(50% - (54px / 2));
    position: absolute;
    opacity: 0;
    transform: scale3d(1, 1, 1);
    transition: transform .25s ease, opacity .1s .25s ease;
    user-select: none;
  }
}

.progress-number__number {
    @include flexContainer('row', center, center);
    @include font(18px, $deepBlue-70, 18px, 500);
    @include size(120px);
    background-color: $bg;
    border-radius: 50%;
    left: calc(50% - (120px / 2)); top: calc(50% - (120px / 2));
    position: absolute;
    transform: scale3d(1, 1, 1);
    user-select: none;
}

// ======================================================
// Hovers
// ======================================================

.milestone {
  $b: &;

  &:hover {
    box-shadow: 0 3px 6px 0 rgba(1,13,46,0.24);
    transition: .25s ease;

    #{$b}__progress {
      border-top: 1px solid $deepBlue-20;
      transition: .25s ease;
    }

    #{$b}__svg {
      
      &--bg path {
        @include svg-color($dark-green);
        opacity: .2;
        // stroke-width: 24px;
        transition: stroke-width .4s ease, opacity .3s ease, fill .3s ease, stroke .3s ease;
      }

      &--fg path {
        // stroke-width: 33px;
        transition: .4s ease;
      }
    }

    .header__svg {
      opacity: 1;
      transform: translate3d(0px, 0px, 0px);
      transition: .25s ease;
    }

    .progress__dot {
      background-color: $tisho-green;
      opacity: 0;
    }

    .progress-number {
      opacity: 1;
      transition: .2s .25s ease;
    }

    .progress__number {
      opacity: 1;
      transform: scale3d(2.2, 2.2, 1);
      transition: transform .25s ease, opacity .2s ease;
    }
  }
}
